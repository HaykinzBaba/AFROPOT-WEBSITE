<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Track My Order | Afropot</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body {
      font-family: "Poppins", sans-serif;
      background-color: #f5f9f4;
      margin: 0;
      padding: 0;
      color: #1a2d16;
    }

    header.navbar {
      background-color: #76b852;
      padding: 1.5rem 2rem;
      text-align: center;
      color: white;
    }

    header.navbar h1 {
      margin: 0;
      font-size: 1.8rem;
    }

    .track-section {
      max-width: 700px;
      background: white;
      margin: 3rem auto;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      padding: 2rem;
      text-align: center;
    }

    .track-section h2 {
      font-size: 1.8rem;
      margin-bottom: 1rem;
    }

    input {
      width: 80%;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      margin-bottom: 1rem;
    }

    .track-btn {
      background-color: #76b852;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.3s;
    }

    .track-btn:hover {
      background-color: #5f9e43;
    }

    .status-box {
      margin-top: 1.5rem;
      background-color: #f0f7ef;
      padding: 1.5rem;
      border-radius: 10px;
      display: none;
      animation: fadeIn 0.6s ease-in;
    }

    .status-icon {
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }

    .progress-bar {
      width: 100%;
      background-color: #ddd;
      border-radius: 5px;
      overflow: hidden;
      margin-top: 1rem;
      height: 10px;
    }

    .progress {
      height: 10px;
      width: 0%;
      background-color: #76b852;
      transition: width 2s ease;
    }

    .receipt-box {
      margin-top: 2rem;
      display: none;
      text-align: left;
      background: #fff;
      padding: 1.5rem;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      animation: fadeIn 0.6s ease;
    }

    .receipt-box h3 {
      text-align: center;
      margin-bottom: 1rem;
      color: #1a2d16;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 1rem;
    }

    th, td {
      border-bottom: 1px solid #ccc;
      padding: 10px;
      text-align: left;
    }

    th {
      background-color: #f0f7ef;
    }

    .reorder-btn {
      display: block;
      background-color: #4CAF50;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      text-align: center;
      margin: 1rem auto 0;
      transition: background 0.3s;
    }

    .reorder-btn:hover {
      background-color: #45a049;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    footer.footer-bottom {
      background-color: #76b852;
      color: white;
      text-align: center;
      padding: 1rem;
      margin-top: 3rem;
    }
  </style>
</head>
<body>

<header class="navbar">
  <h1>Track My Order - Afropot</h1>
</header>

<section class="track-section">
  <h2>Enter Your Order Email or ID</h2>
  <input type="text" id="orderInput" placeholder="e.g. respectme060@gmail.com or #AFR1234">
  <br>
  <button class="track-btn" onclick="trackOrder()">Track Order</button>

  <div class="status-box" id="statusBox">
    <div class="status-icon" id="statusIcon">üïí</div>
    <h3 id="statusText">Checking your order status...</h3>
    <p id="estimatedTime"></p>

    <div class="progress-bar">
      <div class="progress" id="progressBar"></div>
    </div>
  </div>

  <div class="receipt-box" id="receiptBox">
    <h3>üßæ Your Order Receipt</h3>
    <table id="receiptTable">
      <thead>
        <tr>
          <th>Item</th>
          <th>Price (‚Ç¨)</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <p><strong>Total:</strong> <span id="receiptTotal">‚Ç¨0.00</span></p>
    <p><strong>Delivery Address:</strong> <span id="receiptAddress"></span></p>
    <p><strong>Payment:</strong> <span id="receiptPayment"></span></p>
    <button class="reorder-btn" onclick="reorder()">Reorder Again üçΩÔ∏è</button>
  </div>
</section>

<footer class="footer-bottom">
  <p>¬© 2025 Afropot | Nigerian Food Ordering & Delivery Platform | All Rights Reserved.</p>
</footer>

<script>
function trackOrder() {
  const orderInput = document.getElementById("orderInput").value.trim();
  const statusBox = document.getElementById("statusBox");
  const statusText = document.getElementById("statusText");
  const statusIcon = document.getElementById("statusIcon");
  const progressBar = document.getElementById("progressBar");
  const estimatedTime = document.getElementById("estimatedTime");
  const receiptBox = document.getElementById("receiptBox");

  if (!orderInput) {
    alert("Please enter your email or Order ID to track your order.");
    return;
  }

  const savedOrder = JSON.parse(localStorage.getItem("afropotLastOrder"));

  if (!savedOrder) {
    alert("‚ùå No orders found on this device.");
    return;
  }

  if (
    orderInput.toLowerCase() !== savedOrder.email.toLowerCase() &&
    orderInput !== savedOrder.orderId
  ) {
    alert("‚ö†Ô∏è No order matches that email or Order ID.");
    return;
  }

  // Display order status
  statusBox.style.display = "block";
  receiptBox.style.display = "block";

  statusText.innerHTML = `Order <b>${savedOrder.orderId}</b> for <b>${savedOrder.name}</b>`;
  statusIcon.textContent = "üîé";
  progressBar.style.width = "20%";
  estimatedTime.textContent = "Fetching status...";

  // Animate tracking
  setTimeout(() => {
    statusText.textContent = "Order confirmed ‚úÖ";
    statusIcon.textContent = "üì¶";
    progressBar.style.width = "40%";
    estimatedTime.textContent = "Estimated delivery: 30 mins";
  }, 1500);

  setTimeout(() => {
    statusText.textContent = "Chef is preparing your meal üë®‚Äçüç≥";
    statusIcon.textContent = "üç≥";
    progressBar.style.width = "65%";
  }, 3500);

  setTimeout(() => {
    statusText.textContent = "Your order is on the way üö¥‚Äç‚ôÇÔ∏è";
    statusIcon.textContent = "üöö";
    progressBar.style.width = "90%";
    estimatedTime.textContent = "Estimated delivery: 10 mins";
  }, 5500);

  setTimeout(() => {
    statusText.textContent = "Delivered! üéâ Enjoy your meal üç≤";
    statusIcon.textContent = "‚úÖ";
    progressBar.style.width = "100%";
    estimatedTime.textContent = `Delivered to ${savedOrder.address}`;
  }, 7500);

  // Show receipt
  const tbody = document.querySelector("#receiptTable tbody");
  tbody.innerHTML = "";
  savedOrder.items.forEach(item => {
    const row = document.createElement("tr");
    row.innerHTML = `<td>${item.name}</td><td>‚Ç¨${item.price.toFixed(2)}</td>`;
    tbody.appendChild(row);
  });

  document.getElementById("receiptTotal").textContent = `‚Ç¨${savedOrder.total}`;
  document.getElementById("receiptAddress").textContent = savedOrder.address;
  document.getElementById("receiptPayment").textContent = savedOrder.payment;
}

function reorder() {
  const savedOrder = JSON.parse(localStorage.getItem("afropotLastOrder"));
  if (!savedOrder) {
    alert("No previous order found to reorder.");
    return;
  }
  localStorage.setItem("afropotCart", JSON.stringify(savedOrder.items));
  alert("‚úÖ Your last order has been added to the cart again!");
  window.location.href = "menu.html";
}
</script>

</body>
</html>
